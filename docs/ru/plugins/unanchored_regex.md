# [unanchored_regex] Регэксп без якорей

В NGINX при использовании регулярного выражения в `location` рекомендуется ставить якоря хотя бы на начало или конец строки. Иначе шаблон будет совпадать с любой частью пути, что ведёт к неожиданностям и просадке производительности.

Например, следующий блок совпадёт с любым URL, содержащим `/v1/`:

```nginx
location ~ /v1/ {
    # ...
}
```

Совпадёт:

- `/v1/`
- `/v1/foo`
- `/foo/v1/bar`
- `/foo/v1/`

Чтобы совпадение было только с путями, начинающимися с `/v1/`, добавьте якорь:

```nginx
location ~ ^/v1/ {
    # ...
}
```

Для расширений файлов (например, PHP) якорь нужен на конец строки.

Неверно:

```nginx
location ~ \.php {
    # ...
}
```

Это совпадёт с любым URL, содержащим `.php`: `/foo.php`, `/foo.phpanything` — что неверно.

Верно:

```nginx
location ~ \.php$ {
    # ...
}
```

Так совпадают только пути, оканчивающиеся на `.php`.

--8<-- "ru/snippets/nginx-extras-cta.md"
